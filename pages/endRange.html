<!DOCTYPE html>
<html>
<head>
    <title>军事智能·机器阅读</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="http://apps.bdimg.com/libs/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../bootstrap-table/bootstrap-table.min.css">
    <link href="apply.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="../css/member.css">
    <link href="../css/header.css" rel="stylesheet" type="text/css" />
    <style>
        .rowLeft { margin-left: -23px; }
        @media (max-width:480px) {
            .rowLeft {
                margin-left: -15px;
            }
        }
    </style>
</head>

<!--<body style="background-image: url('http://pb2edde5m.bkt.clouddn.com/bgPic.png');" id="showBody">-->
<body style="background: url('../images/range4.jpg') no-repeat;background-size: 100% 100%;width: 100vw;height: 100vh;" id="showBody">
<header class="header fixed clearfix navbar navbar-fixed-top">
    <div class="container">
        <div class="row rowLeft">
            <div class="col-md-12">
                <div class="header-left">
                    <div class="logo smooth-scroll">
                        <a href="../index.html"><img id="logo" src="http://pb2edde5m.bkt.clouddn.com/logo2.png" alt="Worthy"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="container auditContainer">
    <div class="row main-content">
        <div class="col-md-12 toTop">
            <h3 class="title-main">
                比赛排行
            </h3>
            <div class="row">
                <hr>
                <div class="col-md-12 row-fluid childToTop">
                    <!-- 成绩表格 -->
                    <div class="col-md-12 group-info" style="padding: 10px 10px;">

                        <!-- tab页开始 -->
                        <ul class="nav nav-tabs" role="tablist">
                            <li role="presentation" class="active"><a href="#trainingScoreInfo" aria-controls="home" role="tab" data-toggle="tab">训练成绩</a></li>
                            <li role="presentation"><a href="#preliminaryScoreInfo" aria-controls="profile" role="tab" data-toggle="tab">初赛成绩</a></li>
                            <li role="presentation"><a href="#finalScoreInfo" aria-controls="profile" role="tab" data-toggle="tab">决赛成绩</a></li>
                        </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="trainingScoreInfo">
                                <div class="col-md-12" style="padding: 0">
                                    <!--<table class="table table-bordered">
                                        <thead>
                                        <tr>
                                            <th>
                                                BLEU_4
                                            </th>
                                            <th>
                                                ROUGE
                                            </th>
                                            <th>
                                                日期
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody id="TeamScore">
                                        </tbody>
                                    </table>-->
                                    <div>
                                        <table id="trainingScoreInfoTable">
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div role="tabpanel" class="tab-pane" id="preliminaryScoreInfo">
                                <div class="col-md-12" style="padding: 0">
                                    <div>
                                        <table id="preliminaryScoreInfoTable">
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div role="tabpanel" class="tab-pane" id="finalScoreInfo">
                                <div class="col-md-12" style="padding: 0">
                                    <div>
                                        <table id="finalScoreInfoTable">
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- tab页结束 -->

                    </div>
                    <br>
                </div>
            </div>
            <br>
            <br>
        </div>
    </div>
</div>

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="http://apps.bdimg.com/libs/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="../bootstrap-table/bootstrap-table.min.js"></script>
<script src="../bootstrap-table/bootstrap-table-zh-CN.min.js"></script>
<script src="../js/cookie.js"></script>
<script src="../js/jquery.cookie.js"></script>
<script type="text/javascript" src="../js/jquery.base64.js"></script>
<script src="../js/globalIP.js"></script>
<script type="text/javascript">
    let username = $.cookie("myUsername");
    let password0 = $.cookie("myWPa");
    let password = $.base64.decode(password0);
    let token = username + ':' + password;
    let role = $.cookie("myRole");

    window.onload=function(){

        if ((username != null) && (username !== "null")) {
            if(role === 'admin'){
                getTrainingScore();
                getPreliminaryScoreScore();
                getFinalScore();
            }else{
                document.getElementById("showBody").style.display = "none";
                window.location.href="../index.html";

            }
        }else{
            document.getElementById("showBody").style.display = "none";
            window.location.href="login.html";
        }
    }

    //训练成绩
    function getTrainingScore(){
        $.ajax({
            type: "GET",
            dataType: "json",
            data: { type: 0 },
            url: IpAll() + "users/ranking" ,
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Basic ' + btoa(token));
            },
            success: function (result) {
                let data = result.data;
                console.log(data);
                $("#trainingScoreInfoTable").bootstrapTable('destroy');
                $('#trainingScoreInfoTable').bootstrapTable({
                    sidePagination : "client", // 分页方式：client客户端分页，server服务端分页（*）
                    pagination : true, // 是否显示分页（*）
                    pageNumber: 1,    //如果设置了分页，首页页码
                    pageSize: 30,                       //每页的记录行数（*）
                    pageList: [30,40],        //可供选择的每页的行数（*）
                    search:true,
                    columns: [{
                        field: 'bleu4ScoreT',
                        title: 'BLEU_4',
                        formatter: precentFormatter
                    }, {
                        field: 'rougelScoreT',
                        title: 'ROUGE',
                        formatter: precentFormatter
                    },  {
                        field: 'createTime',
                        title: '提交日期',
                        sortable: true
                    }
                    ],
                    data: data
                });

            },
            error : function(error) {
                let notifyMessage = error.responseJSON.message
                alert(notifyMessage)
            }
        });
    }

    //初赛成绩
    function getPreliminaryScoreScore(){
        $.ajax({
            type: "GET",
            dataType: "json",
            data: { type: 1 },
            url: IpAll() + "users/ranking" ,
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Basic ' + btoa(token));
            },
            success: function (result) {
                let data = result.data;
                console.log(data);
                $("#preliminaryScoreInfoTable").bootstrapTable('destroy');
                $('#preliminaryScoreInfoTable').bootstrapTable({
                    sidePagination : "client", // 分页方式：client客户端分页，server服务端分页（*）
                    pagination : true, // 是否显示分页（*）
                    pageNumber: 1,    //如果设置了分页，首页页码
                    pageSize: 30,                       //每页的记录行数（*）
                    pageList: [30,40],        //可供选择的每页的行数（*）
                    search:true,
                    columns: [{
                        field: 'bleu4ScoreP',
                        title: 'BLEU_4',
                        formatter: precentFormatter
                    }, {
                        field: 'rougelScoreP',
                        title: 'ROUGE',
                        formatter: precentFormatter
                    },  {
                        field: 'createTime',
                        title: '提交日期',
                        sortable: true
                    }
                    ],
                    data: data
                });

            },
            error : function(error) {
                let notifyMessage = error.responseJSON.message
                alert(notifyMessage)
            }
        });
    }

    //决赛成绩
    function getFinalScore(){
        $.ajax({
            type: "GET",
            dataType: "json",
            data: { type: 2 },
            url: IpAll() + "users/ranking" ,
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'Basic ' + btoa(token));
            },
            success: function (result) {
                let data = result.data;
                console.log(data);
                $("#finalScoreInfoTable").bootstrapTable('destroy');
                $('#finalScoreInfoTable').bootstrapTable({
                    sidePagination : "client", // 分页方式：client客户端分页，server服务端分页（*）
                    pagination : true, // 是否显示分页（*）
                    pageNumber: 1,    //如果设置了分页，首页页码
                    pageSize: 30,                       //每页的记录行数（*）
                    pageList: [30,40],        //可供选择的每页的行数（*）
                    search:true,
                    columns: [{
                        field: 'bleu4ScoreF',
                        title: 'BLEU_4',
                        formatter: precentFormatter
                    }, {
                        field: 'rougelScoreF',
                        title: 'ROUGE',
                        formatter: precentFormatter
                    },  {
                        field: 'createTime',
                        title: '提交日期',
                        sortable: true
                    }
                    ],
                    data: data
                });

            },
            error : function(error) {
                let notifyMessage = error.responseJSON.message
                alert(notifyMessage)
            }
        });
    }

    function precentFormatter(value) {
        return value.toFixed(2) + "%";
    }
</script>
</body>
</html>
